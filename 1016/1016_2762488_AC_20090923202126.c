#include <stdio.h>
const char ml1[6][6]={0,0,5,2,3,4, 0,0,3,4,5,2, 3,5,0,1,0,0, 4,2,0,0,1,0, 5,3,0,0,0,1, 2,4,1,0,0,0},
           ml2[6][6]={0,0,2,3,4,5, 0,0,2,3,4,5, 0,1,0,3,0,5, 0,1,2,0,4,0, 0,1,0,3,0,5, 0,1,2,0,4,0},
           mu1[6][6]={0,0,4,5,2,3, 0,0,4,5,2,3, 1,0,0,5,0,3, 1,0,4,0,2,0, 1,0,0,5,0,3, 1,0,4,0,2,0},
           mu2[6][6]={0,0,0,0,0,0, 0,0,1,1,1,1, 2,2,0,2,0,2, 3,3,3,0,3,0, 4,4,0,4,0,4, 5,5,5,0,5,0},
           mr1[6][6]={0,0,3,4,5,2, 0,0,5,2,3,4, 5,3,0,0,0,1, 2,4,1,0,0,0, 3,5,0,1,0,0, 4,2,0,0,1,0},
           mr2[6][6]={0,0,2,3,4,5, 0,0,2,3,4,5, 0,1,0,3,0,5, 0,1,2,0,4,0, 0,1,0,3,0,5, 0,1,2,0,4,0},
           md1[6][6]={0,0,2,3,4,5, 0,0,2,3,4,5, 0,1,0,3,0,5, 0,1,2,0,4,0, 0,1,0,3,0,5, 0,1,2,0,4,0},
           md2[6][6]={0,0,1,1,1,1, 0,0,0,0,0,0, 4,4,0,4,0,4, 5,5,5,0,5,0, 2,2,0,2,0,2, 3,3,3,0,3,0};
int main(){
    int v[6],from[8][8][6][6][4]={0},mark[8][8][6][6]={0},dist[8][8][6][6],a,b,c,d,bv,b1,b2,b3,b4,psx,psy,pex,pey,ol=0;
    char in[5],o[100000]={0};
    scanf("%s",in);
    psx=in[0]-'a';
    psy=7-(in[1]-'1');
    scanf("%s",in);
    pex=in[0]-'a';
    pey=7-(in[1]-'1');
    for(a=0;a<6;a++)scanf("%d",&v[a]);
    for(a=0;a<8;a++)for(b=0;b<8;b++)for(c=0;c<6;c++)for(d=0;d<6;d++)dist[a][b][c][d]=2000000000;
    from[psx][psy][4][0][0]=-1;
    dist[psx][psy][4][0]=0;
    while(1){
      bv=2000000000;
      for(a=0;a<8;a++)for(b=0;b<8;b++)for(c=0;c<6;c++)for(d=0;d<6;d++)
        if(dist[a][b][c][d]<bv&&mark[a][b][c][d]==0){
          bv=dist[a][b][c][d];
          b1=a;b2=b;b3=c;b4=d;
        }
      if(bv==2000000000)break;
      if(ml1[b3][b4]==0&&ml2[b3][b4]==0){
                                         a++;}
      if(mr1[b3][b4]==0&&mr2[b3][b4]==0){
                                         a++;}
      if(mu1[b3][b4]==0&&mu2[b3][b4]==0){
                                         a++;}
      if(md1[b3][b4]==0&&md2[b3][b4]==0){
                                         a++;}
      mark[b1][b2][b3][b4]=1;
      if(b1>0&&mark[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]]==0&&dist[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]]>bv+v[ml1[b3][b4]]){
        dist[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]]=bv+v[ml1[b3][b4]];
        from[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]][0]=b1;
        from[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]][1]=b2;
        from[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]][2]=b3;
        from[b1-1][b2][ml1[b3][b4]][ml2[b3][b4]][3]=b4;
      }
      if(b2>0&&mark[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]]==0&&dist[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]]>bv+v[mu1[b3][b4]]){
        dist[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]]=bv+v[mu1[b3][b4]];
        from[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]][0]=b1;
        from[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]][1]=b2;
        from[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]][2]=b3;
        from[b1][b2-1][mu1[b3][b4]][mu2[b3][b4]][3]=b4;
      }
      if(b1<7&&mark[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]]==0&&dist[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]]>bv+v[mr1[b3][b4]]){
        dist[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]]=bv+v[mr1[b3][b4]];
        from[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]][0]=b1;
        from[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]][1]=b2;
        from[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]][2]=b3;
        from[b1+1][b2][mr1[b3][b4]][mr2[b3][b4]][3]=b4;
      }
      if(b2<7&&mark[b1][b2+1][md1[b3][b4]][md2[b3][b4]]==0&&dist[b1][b2+1][md1[b3][b4]][md2[b3][b4]]>bv+v[md1[b3][b4]]){
        dist[b1][b2+1][md1[b3][b4]][md2[b3][b4]]=bv+v[md1[b3][b4]];
        from[b1][b2+1][md1[b3][b4]][md2[b3][b4]][0]=b1;
        from[b1][b2+1][md1[b3][b4]][md2[b3][b4]][1]=b2;
        from[b1][b2+1][md1[b3][b4]][md2[b3][b4]][2]=b3;
        from[b1][b2+1][md1[b3][b4]][md2[b3][b4]][3]=b4;
      }
    }
    bv=2000000000;
    for(a=0;a<6;a++)for(b=0;b<6;b++)if(dist[pex][pey][a][b]<bv){
      bv=dist[pex][pey][a][b];
      b3=a;b4=b;
    }
    a=pex;b=pey;c=b3;d=b4;
    printf("%d",dist[a][b][c][d]+v[4]);
    while(from[a][b][c][d][0]!=-1){
      o[ol]=7-(char)b+'1';
      o[ol+1]=(char)a+'a';
      o[ol+2]=' ';
      ol+=3;
      b1=from[a][b][c][d][0];
      b2=from[a][b][c][d][1];
      b3=from[a][b][c][d][2];
      b4=from[a][b][c][d][3];
      a=b1;b=b2;c=b3;d=b4;
    }
    printf(" %c%c",(char)psx+'a',7-(char)psy+'1');
    for(a=ol-1;a>=0;a--)putchar(o[a]);
}
